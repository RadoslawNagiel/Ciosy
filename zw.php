<!DOCTYPE html>
<head>
	<meta charset='utf-8'>
	<title>LP</title>
	<link rel=stylesheet href=main.css>
	<link rel="Shortcut icon" href="ikona.ico" />
</head>
<body style='background-color:#6bab40;color:#dbc8a7; font-size:20px;'>
<?php
session_start();
	if(!isset($_SESSION['id_profil']))
		header("Location: index.php"); 
?>
<center>
<canvas id="gc" width="1000" height="600" onmousemove="mouseMove(event)"></canvas>
<script src="gwoda.js"></script>
<script>
function generate(){for(gwater(),x=0;x<mapaSzer;x++)for(y=0;y<mapaWys;y++)0==pole[x][y]&&(los=Math.random(),los<.04?0==pole[x][y+1]&&(typ=Math.floor(4*Math.random())+1,delay=Math.floor(30*Math.random()),pole[x][y+1]=1,drzewa[x][y+1]=new Drzewo(typ,delay)):los<.05?pole[x][y]=2:los<.06?pole[x][y]=6:los<.08?pole[x][y]=7:los<.1?(los=Math.random(),stan=!0,delay=0,los<.5&&(stan=!1,delay=Math.floor(20*Math.random())),typ=Math.floor(4*Math.random()+1),pole[x][y]=9+typ/10,bushs[x][y]=new Bush(typ,stan,delay)):los<.102?(pole[x][y]=mobID,los=Math.random(),los<.06?mobs[mobID]=new Mob(mobID,x,y,"mammoth",200,100,500):los<.53?mobs[mobID]=new Mob(mobID,x,y,"boar",30,15,100):mobs[mobID]=new Mob(mobID,x,y,"wolf",20,5,40),mobID++):pole[x][y]=0)}function game(){for(gameTimer+=2778e-7,moveX<0&&(posX<szer||kolizja(37))?moveX=0:moveX>0&&(posX>mapaSzer-szer||kolizja(39))&&(moveX=0),moveY<0&&(posY<wys||kolizja(38))?moveY=0:moveY>0&&(posY>mapaWys-wys||kolizja(40))&&(moveY=0),zycie>0?(eq||craft||(posX+=moveX,posY+=moveY),glodDelay<=0?(glodDelay=glodMaxDelay,glod>0&&glod--):glodDelay--,picieDelay<=0?(picieDelay=picieMaxDelay,pragnienie>0&&pragnienie--):picieDelay--,pragnienie<=0||glod<=0?smiercDelay<=0?(zycie--,smiercDelay=smiercMaxDelay,powolnaSmierc.x=390,powolnaSmierc.y=240,powolnaSmierc.text="-1",powolnaSmierc.pokaz=!0):smiercDelay--:zycie<100&&(zycieDelay<=0?(pragnienie>zycie&&glod>zycie&&zycie++,zycieDelay=zycieMaxDelay):zycieDelay--)):(eq=!1,craft=!1),pX=Math.round(posX),pY=Math.round(posY),ctx.fillStyle="#2d6b1d",ctx.fillRect(0,0,canv.width-200,canv.height),pokazMape(),eq||craft||pokazPostac(),x=0;x<szer;x++)for(y=0;y<wys;y++)1==pole[x+pX-10][y+pY-6]&&(14==y&&drzewa[x+pX-10][y+pY-6].rosnij(),3==drzewa[x+pX-10][y+pY-6].typ?ctx.drawImage(tree3l,x*size+(pX-posX)*size,y*size+(pY-posY)*size):4==drzewa[x+pX-10][y+pY-6].typ&&ctx.drawImage(tree4l,x*size+(pX-posX)*size,y*size+(pY-posY)*size));pX=Math.round(posX-.49),pY=Math.round(posY-.49),pole[pX][pY]>999&&zycie>0&&walka(),mobHit.pokaz&&mobHit.pokazTekst(),playerHit.pokaz&&playerHit.pokazTekst(),powolnaSmierc.pokaz&&powolnaSmierc.pokazTekst(),eq?pokazEkwipunek():craft&&pokazCrafting(),pokazMenu()}function keyDown(e){if(zycie>0)switch(e.keyCode){case 37:case 65:moveX=-speed;break;case 38:case 87:moveY=-speed;break;case 39:case 68:moveX=speed;break;case 40:case 83:moveY=speed;break;case 13:case 32:eq||craft||(pX=Math.round(posX-.49),pY=Math.round(posY-.79),podnies(1==pole[pX][pY+1]&&4==drzewa[pX][pY+1].typ?8:pole[pX][pY]));break;case 69:eq&&klikniecie.start&&(ekwipunek[klikniecie.poleX][klikniecie.poleY].klikniecie=!1,klikniecie.start=!1),craft||(eq=!eq);break;case 67:eq||(craft=!craft);break;case 49:select=1;break;case 50:select=2;break;case 51:select=3;break;case 52:select=4;break;case 53:select=5;break;case 81:7!=ekwipunek[select-1][5].id||rzucenie.stan?(5==ekwipunek[select-1][5].id||ekwipunek[select-1][5].id>9&&ekwipunek[select-1][5].id<10)&&zjedz(ekwipunek[select-1][5].id):rzucenie.start()}}function keyUp(e){switch(e.keyCode){case 37:case 65:case 39:case 68:moveX=0;break;case 38:case 87:case 40:case 83:moveY=0}}function loadImage(){postac=document.createElement("IMG"),postac.setAttribute("src","img/postac.png"),postacl=document.createElement("IMG"),postacl.setAttribute("src","img/postacl.png"),postacp=document.createElement("IMG"),postacp.setAttribute("src","img/postacp.png"),postact=document.createElement("IMG"),postact.setAttribute("src","img/postact.png"),postacwl=document.createElement("IMG"),postacwl.setAttribute("src","img/postacwl.png"),postacwp=document.createElement("IMG"),postacwp.setAttribute("src","img/postacwp.png"),zbieraniegif=document.createElement("IMG"),zbieraniegif.setAttribute("src","img/zbieraniegif.png"),postacgif=document.createElement("IMG"),postacgif.setAttribute("src","img/postacgif.png"),postaclgif=document.createElement("IMG"),postaclgif.setAttribute("src","img/postaclgif.png"),postacpgif=document.createElement("IMG"),postacpgif.setAttribute("src","img/postacpgif.png"),postactgif=document.createElement("IMG"),postactgif.setAttribute("src","img/postactgif.png"),postacwpgif=document.createElement("IMG"),postacwpgif.setAttribute("src","img/postacwpgif.png"),dead=document.createElement("IMG"),dead.setAttribute("src","img/dead.png"),tree1=document.createElement("IMG"),tree1.setAttribute("src","img/tree1.png"),tree2=document.createElement("IMG"),tree2.setAttribute("src","img/tree2.png"),tree3=document.createElement("IMG"),tree3.setAttribute("src","img/tree3.png"),tree4=document.createElement("IMG"),tree4.setAttribute("src","img/tree4.png"),tree3l=document.createElement("IMG"),tree3l.setAttribute("src","img/tree3l.png"),tree4l=document.createElement("IMG"),tree4l.setAttribute("src","img/tree4l.png"),water=document.createElement("IMG"),water.setAttribute("src","img/water.png"),water0=document.createElement("IMG"),water0.setAttribute("src","img/water0.png"),water1=document.createElement("IMG"),water1.setAttribute("src","img/water1.png"),water2=document.createElement("IMG"),water2.setAttribute("src","img/water2.png"),water3=document.createElement("IMG"),water3.setAttribute("src","img/water3.png"),water4=document.createElement("IMG"),water4.setAttribute("src","img/water4.png"),water5=document.createElement("IMG"),water5.setAttribute("src","img/water5.png"),waterr=document.createElement("IMG"),waterr.setAttribute("src","img/waterr.png"),splash=document.createElement("IMG"),splash.setAttribute("src","img/splash.png"),stone=document.createElement("IMG"),stone.setAttribute("src","img/stone.png"),stick=document.createElement("IMG"),stick.setAttribute("src","img/stick.png"),rock=document.createElement("IMG"),rock.setAttribute("src","img/rock.png"),meat=document.createElement("IMG"),meat.setAttribute("src","img/meat.png"),leaf=document.createElement("IMG"),leaf.setAttribute("src","img/leaf.png"),pickaxe=document.createElement("IMG"),pickaxe.setAttribute("src","img/pickaxe.png"),shovel=document.createElement("IMG"),shovel.setAttribute("src","img/shovel.png"),spear=document.createElement("IMG"),spear.setAttribute("src","img/spear.png"),bowl=document.createElement("IMG"),bowl.setAttribute("src","img/bowl.png"),ax=document.createElement("IMG"),ax.setAttribute("src","img/ax.png"),campfire=document.createElement("IMG"),campfire.setAttribute("src","img/campfire.png"),club=document.createElement("IMG"),club.setAttribute("src","img/club.png"),boar=document.createElement("IMG"),boar.setAttribute("src","img/boar.png"),wolf=document.createElement("IMG"),wolf.setAttribute("src","img/wolf.png"),mammoth=document.createElement("IMG"),mammoth.setAttribute("src","img/mammoth.png"),bush=document.createElement("IMG"),bush.setAttribute("src","img/bush.png"),bush1=document.createElement("IMG"),bush1.setAttribute("src","img/bush1.png"),bush2=document.createElement("IMG"),bush2.setAttribute("src","img/bush2.png"),bush3=document.createElement("IMG"),bush3.setAttribute("src","img/bush3.png"),bush4=document.createElement("IMG"),bush4.setAttribute("src","img/bush4.png"),fruit1=document.createElement("IMG"),fruit1.setAttribute("src","img/fruit1.png"),fruit2=document.createElement("IMG"),fruit2.setAttribute("src","img/fruit2.png"),fruit3=document.createElement("IMG"),fruit3.setAttribute("src","img/fruit3.png"),fruit4=document.createElement("IMG"),fruit4.setAttribute("src","img/fruit4.png"),strz=document.createElement("IMG"),strz.setAttribute("src","img/strz.png"),E=document.createElement("IMG"),E.setAttribute("src","img/E.png")}function kolizja(e){switch(speedX=speedY=0,e){case 37:speedX-=speed;break;case 38:speedY-=speed;break;case 39:speedX+=speed;break;case 40:speedY+=speed}if(pX=Math.round(posX-.49+speedX),pY=Math.round(posY-.49+speedY),1==pole[pX][pY]){if(pX1=pX,pX2=pX,pY1=pY,1==drzewa[pX][pY].typ?(pX1=Math.round(posX-.49+speedX-.35),pX2=Math.round(posX-.49+speedX+.25),pY1=Math.round(posY-.96+speedY)):(pX1=Math.round(posX-.49+speedX-.25),pX2=Math.round(posX-.49+speedX+.15)),pX1==pX&&pX2==pX&&pY1==pY)return!0}else if(2==pole[pX][pY]){if(pY2=Math.round(posY-.66+speedY),pY2==pY)return!0}else{if(3==pole[pX][pY]||pole[pX][pY]>=3.09&&pole[pX][pY]<4)return!0;if(pole[pX][pY]>=9&&pole[pX][pY]<10&&(pY2=Math.round(posY-.66+speedY),pY==pY2))return!0}return!1}function podnies(e){if(pX=Math.round(posX-.49),pY=Math.round(posY-.79),e>4&&9>e||e>9&&10>e&&bushs[pX][pY].stan||e>=10&&17>e){for(y=0;y<6;y++)for(x=0;x<5;x++)if(e==ekwipunek[x][y].id&&ekwipunek[x][y].id&&ekwipunek[x][y].ilosc<ekwipunek[x][y].max)return 8==e?(ekwipunek[x][y].ilosc++,0):e>9&&10>e?(ekwipunek[x][y].ilosc++,bushs[pX][pY].podnies(),animacjaPodnies=!0,0):(ekwipunek[x][y].ilosc++,pole[pX][pY]=0,5==e&&(ekwipunek[x][y].max=5),0);y=4;do for(y++,6==y&&(y=0),x=0;x<5;x++)if(!ekwipunek[x][y].id)return 8==e?(ekwipunek[x][y].id=8,ekwipunek[x][y].max=20):e>9&&10>e?(animacjaPodnies=!0,ekwipunek[x][y].id=e,bushs[pX][pY].podnies(),ekwipunek[x][y].max=10):e>=10&&17>e?(ekwipunek[x][y].id=e,ekwipunek[x][y].max=1):(ekwipunek[x][y].id=e,ekwipunek[x][y].max=10,5==e&&(ekwipunek[x][y].max=5),pole[pX][pY]=0),ekwipunek[x][y].ilosc++,0;while(4!=y)}}function walka(e){pX=Math.round(posX-.49),pY=Math.round(posY-.49),Id=pole[pX][pY],ctx.fillStyle="black",ctx.font="20px Arial",ctx.fillText(mobs[Id].live,405+(mobs[Id].Px-posX)*size,335+(mobs[Id].Py-posY)*size),walkaDelay<=0?(walkaDelay=maxWalkaDelay,los=Math.round(Math.random()*maxAtak),mobs[Id].live-=los,mobHit.x=380+(mobs[Id].Px-posX)*size,mobHit.y=330+(mobs[Id].Py-posY)*size,mobHit.animPost=!0,mobHit.text="-"+los,mobHit.pokaz=!0):walkaDelay-=1,mobs[Id].delay<=0?(mobs[Id].delay=mobs[Id].maxDelay,los=Math.round(Math.random()*mobs[Id].atak),zycie-=los,zycie<0&&(zycie=0),playerHit.x=390,playerHit.y=240,playerHit.text="-"+los,playerHit.pokaz=!0):mobs[Id].delay-=1,mobs[Id].live<=0&&(mobs[Id].destroy,pole[pX][pY]=5)}function Mob(e,t,i,s,a,o,c){this.id=e,this.Px=t,this.Py=i,this.nazwa=s,this.live=a,this.atak=o,this.delay=c,this.maxDelay=c}function Napis(e){this.pokaz=e,this.text=0,this.x=0,this.y=0,this.animPost=!1,this.delay=30,this.maxDelay=30,this.pokazTekst=function(){ctx.fillStyle="red",ctx.font="20px Arial",ctx.fillText(this.text,this.x,this.y),this.y--,this.delay--,this.delay<=0&&(this.delay=this.maxDelay,this.pokaz=!1)}}function pokazPostac(){if(zycie<=0)ctx.drawImage(dead,378,243);else if(mobHit.pokaz&&mobHit.animPost)2==ost?ctx.drawImage(postacwp,378,243):ctx.drawImage(postacwl,378,243);else if(animacjaPodnies)ost=3,animacja(4);else if(moveX<0)ost=1,animacja(1);else if(moveX>0)ost=2,animacja(2);else if(moveY<0)ost=3,animacja(3);else if(moveY>0)ost=0,animacja(0);else switch(ost){case 0:ctx.drawImage(postac,378,243);break;case 1:ctx.drawImage(postacl,378,243);break;case 2:ctx.drawImage(postacp,378,243);break;case 3:ctx.drawImage(postact,378,243)}}function pokazMenu(){for(ctx.fillStyle="#3d3922",ctx.fillRect(canv.width-220,0,220,canv.height),ctx.fillStyle="#6b643f",ctx.fillRect(canv.width-200,20,180,300),ctx.fillStyle="#3d3922",ctx.fillRect(0,0,20,canv.height),ctx.fillRect(0,0,canv.width,20),ctx.fillRect(0,canv.height-20,canv.width,20),x=0;x<5;x++)select==x+1?ctx.fillStyle="#3d3d3d":ctx.fillStyle="#3d3922",ctx.fillRect(canv.width-195+35*x,canv.height-345,30,60),ctx.fillStyle="#82794e",ctx.font="20px Arial",0!=ekwipunek[x][5].id&&(ctx.drawImage(nazwaPrzedmiotu(ekwipunek[x][5].id),canv.width-200+35*x,canv.height-345,40,40),polX=192,ekwipunek[x][5].ilosc<10&&(polX=185),ctx.fillText(ekwipunek[x][5].ilosc,canv.width-polX+35*x,canv.height-290));ctx.fillStyle="#262626",ctx.fillRect(canv.width-200,canv.height-270,50,250),ctx.fillRect(canv.width-135,canv.height-270,50,250),ctx.fillRect(canv.width-70,canv.height-270,50,250),ctx.fillStyle="#8c050c",ctx.fillRect(canv.width-200,canv.height-20-2.5*zycie,50,2.5*zycie),ctx.fillStyle="#2687b5",ctx.fillRect(canv.width-135,canv.height-20-2.5*pragnienie,50,2.5*pragnienie),ctx.fillStyle="#c4766c",ctx.fillRect(canv.width-70,canv.height-20-2.5*glod,50,2.5*glod),ctx.fillStyle="#cecece",ctx.font="20px Arial",ctx.fillText("X: "+pX+"  Y: "+pY,810,50),ctx.fillText(zycie,807,470),ctx.fillText(pragnienie,872,470),ctx.fillText(glod,937,470)}function nazwaPrzedmiotu(e){switch(e){case 0:return"";case 2:return rock;case 5:return meat;case 6:return stick;case 7:return stone;case 8:return leaf;case 9.1:return fruit1;case 9.2:return fruit2;case 9.3:return fruit3;case 9.4:return fruit4;case 10:return ax;case 11:return shovel;case 12:return pickaxe;case 13:return bowl;case 14:return campfire;case 15:return club;case 16:return spear;default:return E}}function zjedz(e){switch(e){case 5:glod<100&&(ekwipunek[select-1][5].ilosc--,0==ekwipunek[select-1][5].ilosc&&(ekwipunek[select-1][5].id=0),glod<91?glod+=10:glod=100);break;case 9.1:zycie<100&&(ekwipunek[select-1][5].ilosc--,0==ekwipunek[select-1][5].ilosc&&(ekwipunek[select-1][5].id=0),zycie<91?zycie+=5:zycie=100);break;case 9.2:case 9.3:case 9.4:glod<100&&(ekwipunek[select-1][5].ilosc--,0==ekwipunek[select-1][5].ilosc&&(ekwipunek[select-1][5].id=0),glod<96?glod+=5:glod=100)}}function pokazMape(){for(x=0;x<szer;x++)for(y=0;y<wys;y++)if(pole[x+pX-10][y+pY-7]>0&&pole[x+pX-10][y+pY-7]<1e3)if(pole[x+pX-10][y+pY-7]>9&&pole[x+pX-10][y+pY-7]<10)if(bushs[x+pX-10][y+pY-7].stan)switch(pole[x+pX-10][y+pY-7]){case 9.1:ctx.drawImage(bush1,x*size+(pX-posX)*size,y*size+(pY-posY)*size);break;case 9.2:ctx.drawImage(bush2,x*size+(pX-posX)*size,y*size+(pY-posY)*size);break;case 9.3:ctx.drawImage(bush3,x*size+(pX-posX)*size,y*size+(pY-posY)*size);break;case 9.4:ctx.drawImage(bush4,x*size+(pX-posX)*size,y*size+(pY-posY)*size)}else bushs[x+pX-10][y+pY-7].delay<gameTimer&&(bushs[x+pX-10][y+pY-7].stan=!0),ctx.drawImage(bush,x*size+(pX-posX)*size,y*size+(pY-posY)*size);else if(pole[x+pX-10][y+pY-7]>=3&&pole[x+pX-10][y+pY-7]<4){switch(ctx.save(),ctx.translate(0,0),pole[x+pX-10][y+pY-7]){case 3:ctx.drawImage(water,x*size+(pX-posX)*size,y*size+(pY-posY)*size);break;case 3.1:ctx.drawImage(water0,x*size+(pX-posX)*size,y*size+(pY-posY)*size);break;case 3.01:ctx.drawImage(waterr,x*size+(pX-posX)*size,y*size+(pY-posY)*size);break;case 3.02:ctx.rotate(90*Math.PI/180),ctx.drawImage(waterr,y*size+(pY-posY)*size,-x*size-(pX-posX)*size-size);break;case 3.03:ctx.rotate(180*Math.PI/180),ctx.drawImage(waterr,-x*size-(pX-posX)*size-size,-y*size-(pY-posY)*size-size);break;case 3.04:ctx.rotate(270*Math.PI/180),ctx.drawImage(waterr,-y*size-(pY-posY)*size-size,x*size+(pX-posX)*size);break;case 3.11:ctx.drawImage(water1,x*size+(pX-posX)*size,y*size+(pY-posY)*size);break;case 3.12:ctx.rotate(90*Math.PI/180),ctx.drawImage(water1,y*size+(pY-posY)*size,-x*size-(pX-posX)*size-size);break;case 3.13:ctx.rotate(180*Math.PI/180),ctx.drawImage(water1,-x*size-(pX-posX)*size-size,-y*size-(pY-posY)*size-size);break;case 3.14:ctx.rotate(270*Math.PI/180),ctx.drawImage(water1,-y*size-(pY-posY)*size-size,x*size+(pX-posX)*size);break;case 3.21:ctx.drawImage(water2,x*size+(pX-posX)*size,y*size+(pY-posY)*size);break;case 3.22:ctx.rotate(90*Math.PI/180),ctx.drawImage(water2,y*size+(pY-posY)*size,-x*size-(pX-posX)*size-size);break;case 3.23:ctx.rotate(180*Math.PI/180),ctx.drawImage(water2,-x*size-(pX-posX)*size-size,-y*size-(pY-posY)*size-size);break;case 3.24:ctx.rotate(270*Math.PI/180),ctx.drawImage(water2,-y*size-(pY-posY)*size-size,x*size+(pX-posX)*size);break;case 3.31:ctx.drawImage(water3,x*size+(pX-posX)*size,y*size+(pY-posY)*size);break;case 3.32:ctx.rotate(90*Math.PI/180),ctx.drawImage(water3,y*size+(pY-posY)*size,-x*size-(pX-posX)*size-size);break;case 3.33:ctx.rotate(180*Math.PI/180),ctx.drawImage(water3,-x*size-(pX-posX)*size-size,-y*size-(pY-posY)*size-size);break;case 3.34:ctx.rotate(270*Math.PI/180),ctx.drawImage(water3,-y*size-(pY-posY)*size-size,x*size+(pX-posX)*size);break;case 3.41:ctx.drawImage(water4,x*size+(pX-posX)*size,y*size+(pY-posY)*size);break;case 3.42:ctx.rotate(90*Math.PI/180),ctx.drawImage(water4,y*size+(pY-posY)*size,-x*size-(pX-posX)*size-size);break;case 3.43:ctx.rotate(180*Math.PI/180),ctx.drawImage(water4,-x*size-(pX-posX)*size-size,-y*size-(pY-posY)*size-size);break;case 3.44:ctx.rotate(270*Math.PI/180),ctx.drawImage(water4,-y*size-(pY-posY)*size-size,x*size+(pX-posX)*size);break;case 3.51:ctx.drawImage(water5,x*size+(pX-posX)*size,y*size+(pY-posY)*size);break;case 3.52:ctx.rotate(90*Math.PI/180),ctx.drawImage(water5,y*size+(pY-posY)*size,-x*size-(pX-posX)*size-size);break;case 3.53:ctx.rotate(180*Math.PI/180),ctx.drawImage(water5,-x*size-(pX-posX)*size-size,-y*size-(pY-posY)*size-size);break;case 3.54:ctx.rotate(270*Math.PI/180),ctx.drawImage(water5,-y*size-(pY-posY)*size-size,x*size+(pX-posX)*size)}ctx.restore()}else if(1==pole[x+pX-10][y+pY-7])switch(drzewa[x+pX-10][y+pY-7].rosnij(),drzewa[x+pX-10][y+pY-7].typ){case 1:ctx.drawImage(tree1,x*size+(pX-posX)*size,y*size+(pY-posY)*size);break;case 2:ctx.drawImage(tree2,x*size+(pX-posX)*size,y*size+(pY-posY)*size);break;case 3:ctx.drawImage(tree3,x*size+(pX-posX)*size,y*size+(pY-posY)*size);break;case 4:ctx.drawImage(tree4,x*size+(pX-posX)*size,y*size+(pY-posY)*size)}else ctx.drawImage(nazwaPrzedmiotu(pole[x+pX-10][y+pY-7]),x*size+(pX-posX)*size,y*size+(pY-posY)*size);else pole[x+pX-10][y+pY-7]>=1e3&&("boar"==mobs[pole[x+pX-10][y+pY-7]].nazwa?ctx.drawImage(boar,x*size+(pX-posX)*size,y*size+(pY-posY)*size):"wolf"==mobs[pole[x+pX-10][y+pY-7]].nazwa?ctx.drawImage(wolf,x*size+(pX-posX)*size,y*size+(pY-posY)*size):"mammoth"==mobs[pole[x+pX-10][y+pY-7]].nazwa&&ctx.drawImage(mammoth,x*size+(pX-posX)*size-20,y*size+(pY-posY)*size-20));rzucenie.stan&&(rzucenie.przesunKamien(),rzucenie.pokazKamien())}function pokazEkwipunek(){for(ctx.fillStyle="#3d3922",ctx.fillRect(160,120,480,330),ctx.fillStyle="#6b643f",ctx.fillRect(170,130,460,310),x=0;x<5;x++){for(y=0;y<5;y++)ekwipunek[x][y].klikniecie?ctx.fillStyle="#7f7f7f":ctx.fillStyle="#82794e",ctx.fillRect(180+90*x,140+50*y,80,40);ekwipunek[x][5].klikniecie?ctx.fillStyle="#3d3d3d":ctx.fillStyle="#3d3922",ctx.fillRect(180+90*x,390,80,40)}for(ctx.fillStyle="#3d3922",ctx.font="25px Arial",x=0;x<5;x++)for(y=0;y<6;y++)ekwipunek[x][y].id&&(ctx.drawImage(nazwaPrzedmiotu(ekwipunek[x][y].id),180+90*x,140+50*y,40,40),polX=215,ekwipunek[x][y].ilosc<10&&(polX=228),5==y?ctx.fillStyle="#82794e":ctx.fillStyle="#3d3922",ctx.fillText(ekwipunek[x][y].ilosc,polX+90*x,170+50*y));klikniecie.start&&ctx.drawImage(nazwaPrzedmiotu(klikniecie.id),cursorX,cursorY,40,40)}function Slot(e,t,i){this.id=e,this.ilosc=t,this.max=i,this.klikniecie=!1}function mouseMove(e){cursorX=e.offsetX-20,cursorY=e.offsetY-20}function click(){if(eq){if(klikniecie.start){for(x=0;x<5;x++)for(y=0;y<6;y++)if(cursorX>160+90*x&&cursorX<160+90*x+80&&cursorY>120+50*y&&cursorY<120+50*y+40)return pom1=ekwipunek[x][y].id,pom2=ekwipunek[x][y].ilosc,pom3=ekwipunek[x][y].max,ekwipunek[x][y].id=ekwipunek[klikniecie.poleX][klikniecie.poleY].id,ekwipunek[x][y].ilosc=ekwipunek[klikniecie.poleX][klikniecie.poleY].ilosc,ekwipunek[x][y].max=ekwipunek[klikniecie.poleX][klikniecie.poleY].max,ekwipunek[klikniecie.poleX][klikniecie.poleY].id=pom1,ekwipunek[klikniecie.poleX][klikniecie.poleY].ilosc=pom2,ekwipunek[klikniecie.poleX][klikniecie.poleY].max=pom3,ekwipunek[klikniecie.poleX][klikniecie.poleY].klikniecie=!1,klikniecie.start=!1,0}else for(x=0;x<5;x++)for(y=0;y<6;y++)if(cursorX>160+90*x&&cursorX<160+90*x+80&&cursorY>120+50*y&&cursorY<120+50*y+40)return ekwipunek[x][y].id&&(ekwipunek[x][y].klikniecie=!0,klikniecie.id=ekwipunek[x][y].id,klikniecie.start=!0,klikniecie.poleX=x,klikniecie.poleY=y),0}else if(craft){for(i=0;i<5;i++)if(cursorX>180+90*i&&cursorX<260+90*i&&cursorY>140&&cursorY<220&&crafting[i+5*(craftPage-1)].canDoIt){for(sticks=crafting[i+5*(craftPage-1)].sticks,stones=crafting[i+5*(craftPage-1)].stones,leafs=crafting[i+5*(craftPage-1)].leafs,x=0;x<5;x++)for(y=0;y<6;y++)6==ekwipunek[x][y].id?ekwipunek[x][y].ilosc>sticks?(ekwipunek[x][y].ilosc-=sticks,sticks=0):(sticks-=ekwipunek[x][y].ilosc,ekwipunek[x][y].ilosc=0,ekwipunek[x][y].id=0):7==ekwipunek[x][y].id?ekwipunek[x][y].ilosc>stones?(ekwipunek[x][y].ilosc-=stones,stones=0):(stones-=ekwipunek[x][y].ilosc,ekwipunek[x][y].ilosc=0,ekwipunek[x][y].id=0):8==ekwipunek[x][y].id&&(ekwipunek[x][y].ilosc>leafs?(ekwipunek[x][y].ilosc-=leafs,leafs=0):(leafs-=ekwipunek[x][y].ilosc,ekwipunek[x][y].ilosc=0,ekwipunek[x][y].id=0));podnies(crafting[i+5*(craftPage-1)].id)}cursorX>560&&cursorX<600&&cursorY>370&&cursorY<410&&craftPage<3?craftPage++:cursorX>160&&cursorX<200&&cursorY>370&&cursorY<410&&craftPage>1&&craftPage--}}function Mouse(e,t){this.id=e,this.poleX=0,this.poleY=0,this.start=t}function Bush(e,t,i){this.typ=e,this.stan=t,this.delay=i,this.podnies=function(){this.stan=!1,this.delay=this.delay+Math.floor(15*Math.random()+5)}}function Drzewo(e,t){this.typ=e,this.delay=t,this.rosnij=function(){this.typ<4&&this.delay<gameTimer&&(this.typ++,this.delay=this.delay+Math.floor(20*Math.random()+10))}}function Rzut(e,t,i,s,a,o){this.stan=e,this.posX=t,this.posY=i,this.moveX=s,this.moveY=a,this.delay=o,this.sladDelay=15,this.sladX=0,this.sladY=0,this.start=function(){ekwipunek[select-1][5].ilosc--,0==ekwipunek[select-1][5].ilosc&&(ekwipunek[select-1][5].id=0),this.stan=1,this.moveX=0,this.moveY=0,this.sladDelay=0,this.posX=posX-.5,this.posY=posY-1,(moveX>0||2==ost)&&(this.moveX=.14),(moveX<0||1==ost)&&(this.moveX=-.14),(moveY>0||0==ost)&&(this.moveY=.14),(moveY<0||3==ost)&&(this.moveY=-.14),(0!=moveX&&0!=moveY||0==moveX&&0==moveY)&&(this.moveX*=.72,this.moveY*=.72),this.delay=Math.floor(20*Math.random())+70},this.przesunKamien=function(){ppX=Math.round(this.posX),ppY=Math.round(this.posY),this.delay<=0?(pole[ppX][ppY]>=3&&pole[ppX][ppY]<4&&1==this.stan?(los=Math.random(),los<.6&&(this.moveX>.08||this.moveX<-.08||this.moveY<-.08||this.moveY>.08)?this.moveX<.08&&this.moveX>-.08?(this.moveY>0?(this.moveY-=Math.floor(3*Math.random())/100,this.delay+=200*this.moveY):(this.moveY+=Math.floor(3*Math.random())/100,this.delay+=-200*this.moveY),this.moveX+=(Math.floor(3*Math.random())-1)/100):this.moveY<.08&&this.moveY>-.08&&(this.moveX>0?(this.moveX-=Math.floor(3*Math.random())/100,this.delay+=200*this.moveX):(this.moveX+=Math.floor(3*Math.random())/100,this.delay+=-200*this.moveX),this.moveY+=(Math.floor(3*Math.random())-1)/100):this.stan=2,this.sladDelay=20,this.sladX=this.posX,this.sladY=this.posY):0==pole[ppX][ppY]&&(pole[ppX][ppY]=7,this.stan=2),this.sladDelay<=0&&(this.stan=0)):pole[ppX][ppY]>999?(Id=pole[ppX][ppY],los=Math.round(3*Math.random()),mobs[Id].live-=los,mobs[Id].live<=0&&(mobs[Id].destroy,pole[ppX][ppY]=5),mobHit.styl=0,mobHit.x=410+(mobs[Id].Px-posX)*size,mobHit.y=290+(mobs[Id].Py-posY)*size,mobHit.text="-"+los,mobHit.pokaz=!0,mobHit.animPost=!1,this.stan=0,this.sladDelay=0,this.delay=0,this.moveX=0,this.moveY=0):(this.posX+=this.moveX,this.posY+=this.moveY),this.delay--},this.pokazKamien=function(){this.sladDelay>0&&(ctx.drawImage(splash,400+(this.sladX-posX)*size,280+(this.sladY-posY)*size),this.sladDelay--),1==this.stan&&ctx.drawImage(stone,400+(this.posX-posX)*size,280+(this.posY-posY)*size)}}function CraftingSlot(e,t,i,s,a,o){this.name=e,this.id=t,this.page=i,this.sticks=s,this.stones=a,this.leafs=o,this.canDoIt=!1,this.canDo=function(e,t,i){return this.sticks<=e&&this.stones<=t&&this.leafs<=i?(this.canDoIt=!0,!0):(this.canDoIt=!1,!1)}}function createCraftingSlot(){crafting[0]=new CraftingSlot(ax,10,1,3,3,0),crafting[1]=new CraftingSlot(shovel,11,1,3,3,0),crafting[2]=new CraftingSlot(pickaxe,12,1,3,5,0),crafting[3]=new CraftingSlot("",0,1,0,0,0),crafting[4]=new CraftingSlot("",0,1,0,0,0),crafting[5]=new CraftingSlot(bowl,13,2,0,0,40),crafting[6]=new CraftingSlot(campfire,14,2,10,0,20),crafting[7]=new CraftingSlot("",0,2,0,0,0),crafting[8]=new CraftingSlot("",0,2,0,0,0),crafting[9]=new CraftingSlot("",0,2,0,0,0),crafting[10]=new CraftingSlot(club,15,3,6,0,0),crafting[11]=new CraftingSlot(spear,16,3,6,2,0),crafting[12]=new CraftingSlot("",0,3,0,0,0),crafting[13]=new CraftingSlot("",0,3,0,0,0),crafting[14]=new CraftingSlot("",0,3,0,0,0)}function animacja(e){switch(frameXpos=40*Math.round(animacjaStan-1),e){case 0:ctx.drawImage(postacgif,frameXpos,0,40,40,378,243,40,40);break;case 1:ctx.drawImage(postaclgif,frameXpos,0,40,40,378,243,40,40);break;case 2:ctx.drawImage(postacpgif,frameXpos,0,40,40,378,243,40,40);break;case 3:ctx.drawImage(postactgif,frameXpos,0,40,40,378,243,40,40);break;case 4:ctx.drawImage(zbieraniegif,frameXpos,0,40,40,378,243,40,40)}animacjaStan+=animacjaSpeed,animacjaStan>3.4&&(4==e&&(animacjaPodnies=!1),animacjaStan=.5)}function pokazCrafting(){for(sticks=0,stones=0,leafs=0,x=0;x<5;x++)for(y=0;y<6;y++)7==ekwipunek[x][y].id?stones+=ekwipunek[x][y].ilosc:6==ekwipunek[x][y].id?sticks+=ekwipunek[x][y].ilosc:8==ekwipunek[x][y].id&&(leafs+=ekwipunek[x][y].ilosc);for(ctx.fillStyle="#3d3922",ctx.fillRect(160,120,480,330),ctx.fillStyle="#6b643f",ctx.fillRect(170,130,460,310),plus=5*(craftPage-1),x=0;x<5;x++)""!=crafting[x+plus].name&&(crafting[x+plus].canDo(sticks,stones,leafs)?ctx.fillStyle="#82794e":ctx.fillStyle="#7f7f7f",ctx.fillRect(180+90*x,140,80,80),ctx.drawImage(crafting[x+plus].name,180+90*x,140));ctx.save(),ctx.rotate(180*Math.PI/180),ctx.drawImage(strz,-220,-430),ctx.restore(),ctx.drawImage(strz,580,390)}for(window.onload=function(){for(canv=document.getElementById("gc"),ctx=canv.getContext("2d"),loadImage(),generate(),createCraftingSlot();pole[Math.round(posX-.49)][Math.round(posY-.49)]>=3&&pole[Math.round(posX-.49)][Math.round(posY-.49)]<4;)posX++;document.addEventListener("keydown",keyDown),document.addEventListener("keyup",keyUp),document.addEventListener("click",click),setInterval(game,1e3/60)},szer=20,wys=15,mapaSzer=2e3,mapaWys=1e3,size=40,mobID=1e3,mobs=[],bushs=[],drzewa=[],x=0;x<mapaSzer;x++)drzewa[x]=[mapaWys],bushs[x]=[mapaWys];for(moveX=moveY=0,posX=mapaSzer/2,posY=mapaWys/2,ost=0,eq=!1,craft=!1,cursorX=cursorY=0,gameTimer=0,select=1,craftPage=1,klikniecie=new Mouse(0,!1),crafting=[15],ekwipunek=[5],x=0;x<5;x++)for(ekwipunek[x]=[6],y=0;y<6;y++)ekwipunek[x][y]=new Slot(0,0,0);for(pole=[mapaSzer],x=0;x<mapaSzer;x++)for(pole[x]=[mapaWys],y=0;y<mapaWys;y++)pole[x][y]=0;mobHit=new Napis(!1),playerHit=new Napis(!1),powolnaSmierc=new Napis(!1),rzucenie=new Rzut(0,0,0,0,0,0),frameNr=1,maxFrame=4,animacjaDelay=.5,animacjaPodnies=!1,animacjaSpeed=.2,animacjaStan=.5,speed=.06,zycie=100,pragnienie=100,glod=100,picieDelay=500,picieMaxDelay=500,glodDelay=700,glodMaxDelay=700,zycieDelay=300,zycieMaxDelay=300,smiercDelay=100,smiercMaxDelay=100,maxWalkaDelay=60,walkaDelay=60,maxAtak=8;
</script>